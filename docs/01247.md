# Shmoocon 2016: Z-Wave 协议被 SDR 黑

> 原文:[https://hack aday . com/2016/01/16/shmoocon-2016-z-wave-protocol-hacked-with-SDR/](https://hackaday.com/2016/01/16/shmoocon-2016-z-wave-protocol-hacked-with-sdr/)

2016 Shmoocon 的第一场演讲非常精彩。Joseph Hall 和 Ben Ramsey 展示了他们的作品 hacking Z-Wave，这是一个在消费者和工业连接设备方面都获得了巨大市场份额的网络。 [EZ-Wave 使用商用软件定义无线电来开发 Z-Wave 网络](https://github.com/AFITWiSec/EZ-Wave)。这不仅限于嗅，也用于控制潜在的伤害。

Z-Wave 是一种专有的无线协议，工作在 900 Mhz 频谱。这个频谱非常适合穿透墙壁和地板，这也是 Z-Wave 在市场上取得巨大成功的部分原因。

作为他们的研究，约瑟夫和本想看看有什么工具已经可用。OpenZWave 可用，但不支持协议之外的操作。另外两个选项是 Z-Force 和 Scapy0-radio。两者都出现在过去的 Blackhat 会议上，看起来很有前景，但缺乏可用性。他们决定推出自己的产品。

EZ-Wave 是一系列不同的工具。 *ezstumbler* 用于网络发现；我们身边有在用的 Z 波设备吗？ *ezrecon* 一旦发现网络，就会询问设备，产生软件版本、支持的命令、当前状态*和当前配置*。最后两个特征(标有星号)在加密设备上不可用。考虑到这一点，问题就变成了:有多少设备在使用加密技术。我相信你已经猜到了，答案是很少。

Joseph 和 Ramsey 购买了目前市场上的 33 种不同的 Z-Wave 设备并对其进行了测试。测试硬件对我们来说非常熟悉。在演讲中，他们使用一对 [HackRF One](https://greatscottgadgets.com/hackrf/) 演示了检测、联系和控制设备，这是由 Michael Ossmann 开发的壮观装置，他也在今年的 Shmoocon 上。一个单元发布命令，另一个单元监听 Z 波包。

在对这 33 个单元的测试中，研究人员发现只有 9 个使用了加密技术。九个中有五个是 Z-Wave 门锁——因为它们有加密功能。真正的坏消息是，其余四个中的三个有“选择加入”加密，只有在用户明确配置他们使用它时才会运行。

我之前提到过这些未加密系统造成的混乱。在演讲中，一篇讨论工业紧凑型荧光灯损害的论文[被引用，该论文表明，使用特定的时间开关灯泡会造成损害。这是由于热应力——打开它们，它们升温，关闭它们，它们降温，如此重复。关键是要弄清楚在热应力最大化的情况下，它们的切换速度有多快。他们的测试表明，在半个晚上内摧毁紧凑型荧光灯是可能的。为什么？故意伤害本身是一个原因，但工业间谍是另一个原因。如果整个仓库中的所有灯在一夜之间都被破坏了，那么工作将会中断很长一段时间。当然，我们在这个例子中只谈到了节能灯，但还有各种其他设备使用这项技术。我生活在寒冷的气候中。如果有人长时间关闭你的恒温器，你房子里的水管会结冰并爆裂。](http://c.ymcdn.com/sites/www.atmae.org/resource/resmgr/articles/speziamaximizingcfl051511.pdf)

当然，这并不完全是悲观的。这个故事的寓意是，随着联网设备数量的增长，加密必须包括在内，并且应该默认启用。
# 时间领主的数据库

> 原文:[https://hack aday . com/2017/11/20/the-database-of-time-lords/](https://hackaday.com/2017/11/20/the-database-of-the-time-lords/)

自从人类可以比马跑得更快以来，时区一直是一个必要条件，但随着计算机通过庞大的信息网络相互连接，一个更大的问题出现了。你是如何跟踪时区的？此外，如何跟踪历史上的时区呢？

快速提问。如果波士顿现在是中午，凤凰城现在是几点？嗯，波士顿在东部时区，中部时区，凤凰城在山地时区；中午，十一点，十点。如果波士顿现在是中午，那么凤凰城现在是上午 10 点。这里有一个稍微难一点的问题:如果波士顿是中午，那么凤凰城的夏令时是几点？亚利桑那州大部分地区不实行夏令时，所以如果波士顿是中午，那么凤凰城就是上午 9 点。亚利桑那州西北部的纳瓦霍族呢？这里，夏令时*是*观察。你甚至不能规定整个亚利桑那州都是山地标准时间。

印第安纳是另一个奇异时区的例子。在 20 世纪的大部分时间里，印第安纳州一直处于中部时区。从 20 世纪 60 年代开始，东部时间和中部时间之间的界线从俄亥俄州边界慢慢向西移动。一些国家选择不遵守夏令时。2006 年，整个州都开始采用夏令时，但该州的西北角和西南角仍然牢牢地处于中部时区。时区奇怪的地理界限也不仅限于美国；澳大利亚新南威尔士州的布罗肯希尔比新南威尔士州的其他地方晚三十分钟。

找出所有这些问题的可靠答案是时区数据库的领域，它是每个时区、时区变化和每个奇怪的与时间相关的政治争论的目录。它记录了阿拉斯加从儒略历到公历的转变。它描述了 1900 年在密歇根的一个小镇上的一场争论。它被用于 Java，几乎每一种 Linux，数百个软件包，以及至少十几个你现在用来阅读的服务器和路由器。

* * *

夏令时的想法是由本杰明·富兰克林在 1784 年写给《巴黎日报》的一篇文章中首次提出的。一个降低照明成本的经济项目提出，只要简单地根据“太阳”时间将时钟向前或向后移动，就可以减少夜晚点蜡烛的数量。一年下来，这将为巴黎市节省六千四百万磅的蜡烛。富兰克林还建议在蜡烛制造商的商店里设置警卫，这样每个家庭每周不允许购买超过一磅的蜡烛。还有人建议，所有教堂的钟在黎明时分敲响，每条街都要鸣炮，以此来唤醒懒汉，榨取民众的最后一点生产力。

第一份提出偏离太阳时的严肃出版物是查尔斯·费迪南德·多德于 1870 年出版的《铁路国家时间系统》。这份提案当时提交给了铁路部门的负责人，列出了美国各地的时区，尽管细节有些模糊。几年后，在哪里放置这些时区的问题被解决了。1883 年 11 月 18 日——两个中午的日子——教堂的钟声在一小时内敲响了 24 次。

在时区数据库的深处——通常被称为`tz`或简称为 zoneinfo——有数百个有趣的观察和轶事，关于世界不同地区如何观察时间。例如，在 20 世纪 90 年代，南极的阿蒙森-斯科特站与海岸的麦克默多基地使用相同的时区。然而，由于发电机以 60.1 赫兹的频率运转，时钟每隔几天就要调慢五分钟。21 世纪初，巴西的夏令时因选举而推迟了几年。由于巴西使用的电子投票机不能更改时间，因此该国无法在第一轮和第二轮选举之间从标准时间改为夏令时。解决这个问题的方法是改变夏令时开始的日期，改变投票机，或者改变宪法。

* * *

时区数据库的创建者是 Arthur David Olson，他在 1986 年[创建了一个工具来轻松解析不同的时区](http://mm.icann.org/pipermail/tz/1986-November/008946.html)，以及它们所使用的日期。例如，时区“编译器”将解析人类可读的表，并指出历史上的哪个时间点适用哪个时区:

```
# Zone	NAME		GMTOFF	RULE/SAVE	FORMAT	[UNTIL]
Zone	US/Hawaii	-10:30	USA		H%sT	1933 Apr 30 2:00
                        -10:30	1:00		HDT	1933 May 1 2:00
                        -10:30	USA		H%sT	1947 Jun 8 2:00
                        -10:00	-		HST

```

这段代码在 1933 年 4 月 30 日之前在夏威夷应用正常的美国夏令时规则，然后进行夏威夷一天的夏令时，然后切换回标准规则，直到 1947 年 6 月 8 日，最后进入永久标准时间。所有这些在完整性上是精致的，在可读性上是崇高的。

自 1986 年以来，时区志愿者的松散合并不断发展，1993 年，保罗·埃格特提交了一份时区标准化名称的提案。你以前见过这些名字，隐藏在你的 Linux 发行版的时间和日期设置中，OS X，甚至一些至少追溯到 Mac OS 8 的 Macintoshes。每个时区都由一个`MAJOR_REGION/COUNTRY/CITY`格式的名称定义，比如北美/美国/洛杉矶和亚洲/阿富汗/喀布尔。

有了人类和机器可读的编译器以及某种组织命名法，现代时区数据库差不多在 20 世纪 90 年代中期就建立起来了。之后，只需要找到时区在何时何地发生了变化，并将它们输入数据库。这不是一项容易的任务；2015 年，没人知道摩洛哥何时开始实行夏令时。这最初归因于一篇不正确的新闻报道，但更多的调查显示，2012 年的一个版本的数据库错误地预测摩洛哥将在 9 月的最后一个周日回落。

* * *

但是这些更新来自哪里呢？世卫组织搜索新闻，寻找提及夏令时变化的内容。一群有着特殊爱好的志愿者。或者至少了解计算机中的时区实际上是如何更新的。只要发送几封电子邮件，任何人都可以传达这样一个事实:一个独裁者不想在黎明前醒来，或者一个国家因为油价下跌正在改变时区。

时间是我们每个人都要处理的最基本的事情。然而，因为没有人真的想太早起床，我们发明了时钟，时区，并将其政治化。由于铁路和农业的发展，时间是不断变化的，时区的每一次变化都会记录在时区数据库中。它是时间领主的数据库，也是每个 Linux 发行版中最重要的历史文档之一。
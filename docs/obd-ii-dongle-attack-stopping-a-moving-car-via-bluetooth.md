# OBD-II 加密狗攻击:通过蓝牙阻止行驶中的汽车

> 原文：<https://hackaday.com/2017/04/14/obd-ii-dongle-attack-stopping-a-moving-car-via-bluetooth/>

来自 Argus 研究团队的研究人员发现了一种侵入 Bosch Drivelog ODB-II 加密狗的方法，可以将任何类型的恶意数据包注入 CAN 总线。这使得他们能够通过蓝牙连接到加密狗来停止行驶中的车辆的发动机。

Drivelog 是博世用于收集和管理车辆运行数据的智能设备。它允许用户通过蓝牙连接来跟踪油耗，并在需要维修时发出警报。它在两阶段攻击中遭到破坏。第一个漏洞是加密狗和智能手机应用程序之间的身份验证过程中的信息泄漏，允许他们快速暴力破解离线的秘密 PIN 并通过蓝牙连接到加密狗。连接后，加密狗的消息过滤器中的安全漏洞允许他们将恶意消息注入 CAN 总线。

被称为“Just Works”的蓝牙配对机制已由 Bosh 通过激活一个两步验证来修复，以便其他用户注册到一个设备。第二个问题是恶意修改的移动应用可能发送不想要的 CAN 消息的能力，通过对加密狗固件进行更新以进一步限制加密狗能够放在 CAN 总线上的允许命令，该问题将得到缓解。

博世在声明中稍微淡化了这个问题:

> 重要的是要注意，潜在的恶意攻击的可扩展性受到这样一个事实的限制，即这种攻击需要物理上靠近加密狗。这意味着攻击设备需要在车辆的蓝牙范围内。

问题是，物理距离并不等于蓝牙距离。标准蓝牙范围约为 10 米，这是一个很有争议的物理距离，但很容易购买甚至[修改蓝牙](http://hackaday.com/2011/04/15/long-range-bluetooth-wardriving-rig/)加密狗，使其范围扩大 10 倍和 100 倍。当给汽车的 CAN 总线增加无线连接时，制造商有义务确保数据系统不受损害。这个近距离的例子在技术上仍然是一个远程攻击，这是一个最糟糕的漏洞的例子。
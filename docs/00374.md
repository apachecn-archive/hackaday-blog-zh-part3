# 美国国家安全局如何阅读你的电子邮件

> 原文：<https://hackaday.com/2015/10/15/how-the-nsa-can-read-your-emails/>

自 2013 年[斯诺登]公布数千份机密文件以来，有一个问题一直困扰着安全研究人员:美国国家安全局究竟是如何拦截 VPN 流量、解密 SSH 和 HTTP，从而让美国国家安全局读取全球各地数百万封个人私人电子邮件的？每一个猜测都是猜测，但在 ACM 计算机和通信安全会议上发表的一篇论文可能会对美国国家安全局如何破解互联网上最广泛使用的一些加密技术有所帮助。

本文中讨论的相关加密是 Diffie–Hellman 密钥交换(D-H)，这是一种用于 HTTPS、SSH 和 VPN 的加密技术。D-H 依赖于一个共享的非常大的素数。通过执行许多许多计算，攻击者可以预先计算出一个单独的素数的“破解”，然后应用相对较小的计算来解密使用该素数的任何单独的消息。如果所有应用程序都使用不同的质数，这就不是问题了。这就是密码学理论和实践的区别；前 100 万 Alexa HTTPS 域名中有 92%使用相同的两个素数作为 D-H。攻击者可以预先计算这两个素数的破解，从而能够读取通过这些服务器的几乎所有互联网流量。

这种攻击在去年春天[被普通的安全研究人员](https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html)讨论过，在那段时间里，这篇论文背后的研究人员一直在努力工作。早期的讨论集中在 512 位 D-H 素数和[死锁利用](https://weakdh.org/)。从那时起，研究人员就专注于破解更长的 768 位和 1024 位 D-H 素数的可能性。他们得出结论，拥有破解单个 1024 位素数资源的人将允许攻击者解密 66%的 IPsec VPNs 和 26%的 SSH 服务器。

这一发现有一个光明的一面:预计算这些较长素数的“破解”能力只有民族国家才能获得，因为它的规模[已经被比作二战期间破解英格玛密码](https://freedom-to-tinker.com/blog/haldermanheninger/how-is-nsa-breaking-so-much-crypto/)。光是完成这项工作的硬件就要花费数百万美元，尽管这种计算可以用专用集成电路或其他专用硬件来更快地完成，但这也需要大量的资金。当然，这种观察的缺点是，解密最流行的加密协议的能力可能掌握在我们的政府手中。这包括美国国家安全局、中国和其他任何有数亿美元投入到一个黑色项目中的人。
# 艰难地摆脱 3D 打印机:通过编写引导程序

> 原文：<https://hackaday.com/2018/03/13/unbricking-a-3d-printer-the-hard-way-by-writing-a-bootloader/>

当一件设备的固件升级出错时，人们会有一种沮丧的感觉。我们都有可能发生这种情况，并阻止了一两个设备。如果我们幸运，我们可以简单地重新应用升级或恢复到以前的版本，如果我们运气不好，我们不得不潜入串行调试端口，以拯救设备从垃圾堆。但是当这两条路线都失败时会发生什么呢？如果你是[Arko]，你[对设备进行逆向工程，并为它编写你自己的引导程序](http://arkorobotics.com/blog/?p=161)。

这个令人不快的砖块物体是一台 Monoprice MP Mini Delta 3D 打印机，在看到一个朋友的机器没有问题地使用它后，他鲁莽地应用了新的固件。在主电路板上找到相关的调试接口后，他再次升级了固件，却发现他已经覆盖了它的引导程序。这台机器似乎要完蛋了，但他不准备放弃。

在他的文章中，详细分析了 Monoprice 的 STM32F070CB 中的 ARM Cortex M0 处理器的启动机制和存储器映射。我们学习了用于映射中断和执行点的重要地址的向量表，以及引导加载程序在设置它启动的应用程序时的机制。这一部分本身就很值得一读，即使对那些对砖砌 3D 打印机不感兴趣的人也是如此。

最后，他有了一个可以正常工作的引导程序，并在其中添加了应用程序固件，但遗憾的是，当他给打印机加电时，仍然没有任何快乐。问题追溯到执行打印机业务的 ARM 和运行其显示器的 ESP8266 之间的串行连接。在与一位朋友的头脑风暴建议后，找到了一段代码，它可以设置相关的寄存器，使其以正确的速度运行。

因此，经过大量的工作，产生了这个迷人的文章，有一个工作的 3D 打印机。他建议，如果他们的打印机出现问题，普通人可以尝试向买方垄断公司索要替代型号，但我们非常高兴他坚持了下来。如果没有它，我们永远不会有这篇精彩的文章，如果没有学习经历，我们会更穷。

这[不是我们第一次给你带来 3D 打印机引导程序欺骗](https://hackaday.com/2015/03/30/injecting-sd-card-bootloaders/)。
# 你所有的手机都属于我们

> 原文：<https://hackaday.com/2017/07/29/broadpwn-all-your-mobiles-are-belong-to-us/>

Exodus Intel 的研究人员最近[公布了几个 Broadcom WiFi 芯片组上存在的一个缺陷](https://blog.exodusintel.com/2017/07/26/broadpwn/)的细节。据估计，这将影响近**10 亿**设备，从安卓到 iPhone。仅举几个最重要的例子:

*   三星 Galaxy 从 S3 到 S8，包括
*   所有三星 Notes3。Nexus 5、6、6X 和 6P
*   iPhone 5 之后的所有 iPhone

那么这是怎么发生的呢？一个 bug 如何影响这么多不同的设备？

如今的智能手机是一个由互连芯片组成的非常复杂的网络。除了主处理器，还有几个处理特殊任务的辅助处理器，否则会阻塞主 CPU。其中之一是 WiFi 芯片组，它负责 WiFi 无线电通信——处理 PHY、MAC 和 MLME 层。当所有处理完成后，无线电芯片组将数据包传递给运行在主 CPU 上的内核驱动程序。这意味着无线电芯片组本身必须具有相当大的数据处理能力来处理所有这些工作。唉，权力越大，责任越大。

Broadpwn 是针对 Broadcom 的 BCM43xx 系列 WiFi 芯片组的 0 天完全远程攻击。该攻击允许在 Android 和 iOS 上的 WiFi 芯片组本身(以及主应用程序处理器)上执行代码。该芯片组家族基于 ARM Cortex-R4 处理器。由于这个缺陷直接利用了 WiFi 芯片组，所以它独立于主 CPU 中的底层操作系统。一个类似的漏洞，CVE-2017-0561，要求攻击者和受害者在同一个 WPA2 网络上。Broadpwn 没有。它可以用来悄悄利用攻击者范围内的任何设备。这是可能的，因为在任何实际验证之前，WiFi 芯片组固件处理关联响应帧的方式中存在缺陷。

研究人员甚至更进一步，有效地实现了最有可能是第一个 WiFi 蠕虫。受损设备可能会变成移动感染站。简而言之，攻击者监听探测请求。当客户端发布它时，攻击者会模拟接入点并触发漏洞。在受害者身上运行的恶意代码可以重演这种行为，像典型的蠕虫一样传播。

随着一段时间前安全更新的推出，这一缺陷对普通用户的影响尚未见分晓。幸运的是，到目前为止，没有已知的恶意软件利用它。
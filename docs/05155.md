# 了解 DMA

> 原文:[https://hackaday.com/2017/02/28/understanding-dma/](https://hackaday.com/2017/02/28/understanding-dma/)

在计算机的世界里，中央处理器(CPU)是——嗯—*中枢*。你的第一门计算机课程可能会像计算机的大脑一样解释它。然而，有时你可以超载，大脑和 CPU 设计者总是试图使用各种技术来提高速度和吞吐量。其中一种方法是 DMA 或直接内存访问。

顾名思义，DMA 是 I/O 设备直接向内存或从内存传输数据的能力。在某些情况下，它实际上可能会将数据传输到另一个设备，但并不是所有的 DMA 系统都支持这一点。听起来简单，但细节决定成败。由[Andrei Chichak]撰写的关于 DMA 的介绍中有很多信息。它涵盖了不同类型的 DMA 和每种 DMA 所涉及的权衡。

DMA 对于高速传输数据块(例如，来自磁盘驱动器的数据、音频或视频数据)特别有用。它对于慢速数据(如 UARTs)也很有用，这样 CPU 就不必阻塞自身来等待慢速 I/O 设备。在过去，有时处理器不够快，无法读取快速流，但今天处理器很可能已经超快了。你只是不想把它和一个缓慢的 I/O 设备绑在一起。但随着时间的推移，这已经改变了 DMA 架构的工作方式。通常，当块传输完成时，CPU 会收到一个中断，这样它就可以处理传入的数据或者将更多的数据排队发送到设备。

区分 DMA 方案的主要方法是，当内存被另一个设备使用时，处理器会发生什么情况。较旧的处理器很可能使用块模式，在这种模式下，当内存正在使用时，处理器会停止工作。这是有道理的，因为 I/O 设备很可能比 CPU 快，所以在执行指令方面的损失很小。

对于更快的处理器，突发模式 DMA 很受欢迎，因为它会限制 CPU 暂停的时间。事实上，许多现代突发控制器会尝试等待，直到 CPU 不再使用内存，并且只有在短暂传输期间 CPU 尝试使用内存时才会停止。

一些处理器和 DMA 系统可以计算出 CPU 在一段时间内不使用内存的时间，并在这段时间内完全进行传输。这通常被称为透明模式。

你可能认为 DMA 是为“大型计算机”准备的，当然，[Andrei 的]文章集中在 PC、SPARC 和 Atmel SAM 设备上。然而，也提到了 8085(带有外部控制器)上的块模式 DMA。我们还记得 RCA 1802 的 CPU 上有 DMA，这在当时是非常惊人的。正是这种 DMA 使精灵计算机的简单前面板和酷的视频图形芯片成为可能。不可否认，如果你正在用一个现代的操作系统编写，并且你没有编写设备驱动程序，你可能不需要使用 DMA。但是对于您可以轻松分析的实时系统，DMA 不仅可以极大地简化系统，还可以提高整个系统的吞吐量。

虽然这个介绍有很多背景，但它没有展示任何真正的具体例子。如果你想看看[Mike Harrison]在 pic 32 上对 SPI 使用 DMA 的实际结果，请务必阅读我们去年的帖子。
# 用开源心电图拯救生命

> 原文:[https://hack aday . com/2016/04/29/开源心电图拯救生命/](https://hackaday.com/2016/04/29/saving-lives-with-open-source-electrocardiography/)

几个月前， [MobilECG 公司推出了一款强大的心电图机(ECG，也叫 EKG ),外形像名片，配有有机发光二极管显示器，让我们惊叹不已。我们以前见过名片黑客，但这是最酷的。但与它支持的严肃项目相比，这只是微不足道的:制造一种开源的心电图机，它可以在需要的时候，以足够的价格出现在需要的地方，从而拯救生命。](http://hackaday.com/2016/03/13/ekg-business-card-warms-our-hearts/)

该项目名为 MobilECG，是一款开源的可穿戴设备，支持所有主要的 ECG 模式。在他们的演讲中，[彼得·伊斯扎]和[罗伯特·科索达斯]告诉了我们很多关于这到底意味着什么以及心脏是如何工作的。我们学到了很多，休息之后我们会和你分享一些。

 [https://www.youtube.com/embed/omCvrp0ihkY?version=3&rel=1&showsearch=0&showinfo=1&iv_load_policy=1&fs=1&hl=en-US&autohide=2&wmode=transparent](https://www.youtube.com/embed/omCvrp0ihkY?version=3&rel=1&showsearch=0&showinfo=1&iv_load_policy=1&fs=1&hl=en-US&autohide=2&wmode=transparent)

T2】

## 心电图

心脏有四个心室，依次驱动这些不同的肌肉会产生指示性的电信号。当在正确的位置以正确的分辨率测量时，这些信号可以告诉医生很多关于心脏功能的信息。[彼得]为我们安排好了。

例如，测量两个拇指之间的电位会产生一个大约毫伏的信号，持续大约 80 毫秒。这里的技术挑战是将 1 mV 信号与大约 300 mV 基线区分开，同时避免意外引入噪声，淹没微小信号。MobilECG 解决这一问题的方法是，用 24 位 ADC 分辨率解决问题，并在无噪声的情况下用软件进行滤波。这就是他们名片的作用。

但是，如果您愿意连接更多电极，还有一些技巧可以使用，医用 ECG 有 12 个信号，从身体各处的 10 个电极测量。其中四个在手上和脚上，另外六个在胸部靠近心脏的地方。

![ecg_wilsons](../Images/ed9e5a80700299bbc648b376128a904d.png)“威尔逊中央终端”是从手和脚电极计算出来的衍生电压。是其他三个相对于右脚的平均值。该电压用作其他测量的基线，因为它是整个身体的平均读数，所以除了共模噪声之外，它相对不受其他噪声的影响。参考威尔逊的中央终端测量的胸导联的电压给出了关于心脏功能的特别详细的信息，包括心脏病发作的前兆。

消除共模噪声的诀窍是将相反的噪声重新引入体内。这种方法被称为“右腿驱动”，本质上抵消了身体是一个大天线的结果。

当您触摸示波器探头时，您会注意到最大的干扰源是大约 1 伏的 50/60 Hz 电力线信号，它一直在拉高和拉低您的身体电压。右腿驱动消除了这一点，并消除了其他共模信号。

## 信号处理

考虑到这些信号，[Róbert]上台带领我们完成了信用卡演示的设计，它本质上只是一个精密的 ADC。所有的魔法都发生在固件中，而且大部分发生在过滤中。基本上，由于计算复杂性的原因，它们需要使用 IIR 滤波器，但它们无法承受由此带来的失真。如果对数据反向运行 IIR 滤波器，就会抵消这种失真，但这意味着将数据保存在缓冲器中，并对重叠部分运行 IIR。其余的细节都是技术性的，所以如果你想知道更多，可以看看这个演讲或者他们的 GitHub。

这些过滤器适用于所有的信号。然后，为了检测心跳，他们需要寻找其中一个信号的峰值；它叫做“QRS 探测”。这是一种非常聪明的峰值检测算法，死区时间与当前心率成比例，此后阈值下降，直到检测到下一个峰值。像这样使算法自适应有助于抵消患者或电极移动的影响。

## 硬件

[Róbert]为我们总结了主要单元的硬件设计。当然，它都是开放的，所以你可以自由地自己[挖掘细节](https://github.com/peterisza/mobilecg)。

在名片版本使用通用 ADC 的情况下，成熟的设备使用专用模拟前端，基于 ADI 公司的 ADS1298，专为心电图设计。它同时数字化八个通道，并在硬件中计算威尔逊的中央终端和右腿驱动电压。其余的硬件设计是一个 STM32F4 微控制器和一个蓝牙模块来获取数据。测量所有的信号，该设备应该可以依靠内置电池运行一天。对于比手机还小的东西来说，这已经很了不起了。

## 未来

我们认为制造低成本、开源的医疗设备非常棒。这是一种用最少的成本让最多的人得到医疗服务的方式。感谢[Péter]和[Robert]与我们分享您的项目！
# 编写自己的 X86 引导程序

> 原文：<https://hackaday.com/2017/10/23/write-your-own-x86-bootloader/>

如果你想做一个非常精简的机器，并且不需要任何操作系统怎么办？或者也许你想尝试编写自己的操作系统，即使只是为了挑战或乐趣？也许你正在阅读一个很酷的操作系统架构，并对自己说，“我可以写出来！”。好吧，在深入你的代码之前，你首先要写一个叫做引导装载程序的东西。

引导加载程序是在操作系统启动之前，在 PC、Mac、Raspberry Pi 或微控制器的引导序列中运行的代码。它的工作通常是设置最少的硬件，比如 RAM，然后加载操作系统或嵌入式代码。

[Alex Parker]写了一个由三部分组成的清晰的系列博客文章[，使得编写引导装载程序部分变得容易](http://3zanders.co.uk/2017/10/13/writing-a-bootloader/)，至少对于 x86 机器来说是这样。好的一面是，您不需要 x86 就可以开始。他在 Mac 上使用 [QEMU 处理器模拟器](https://www.qemu.org/)来实现，尽管他也谈到在 Windows 和 Linux 下实现。

在该系列的第一部分中，引导程序将您留在 [x86 的真实模式](https://en.wikipedia.org/wiki/Real_mode)中，具有 16 位指令和对 1mb 内存的访问权限——想想 80286 年之前，或者 1982 年对于我们那些当时正在计算的人来说。为了证明它的工作，他使用 BIOS 调用来显示“Hello world！”。这也说明通过 BIOS，你有了一套可以使用的外设。

在第二部分中，他展示了如何设置 32 位[保护模式](https://en.wikipedia.org/wiki/Protected_mode)和一个全局描述符表，使得访问大量内存变得更加容易。

在前两部分中，代码是用汇编语言编写的，因此在第三部分中，他展示了如何将 C++代码加载到内存中并执行它，从而结束了本系列。C++代码当然是你的应用程序，我们会留给你的想象力。

为台式计算机编写引导程序代码的情况相当少见——更不用说微控制器了。例如，[Dmitry Grinberg]编写了自己的引导程序，这样他就可以在 USB 上为他的 AVR 加密 ROM 镜像。我们还讨论了[Lady Ada]的[Arduino boot loaders](https://hackaday.com/2011/08/26/a-beginners-guide-to-burning-arduino-bootloaders/)烧录指南。但是，如果您想了解 x86 上的裸机，引导加载程序是开始的地方。也没那么糟糕。
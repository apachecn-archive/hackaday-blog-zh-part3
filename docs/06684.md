# 使用 NFC 代理硬件“借用”支付卡

> 原文：<https://hackaday.com/2017/07/31/borrow-payment-cards-with-nfc-proxy-hardware/>

非接触式支付越来越受欢迎。该术语通常会让人想起通过将手机放在读卡器上进行支付的能力，但该系统也可以使用嵌入在信用卡、身份证、护照等中的 NFC 标签。NFC 是一种相当安全的支付验证方法，因为它采用了加密技术，客户端和读卡器之间的功能距离只有几十厘米，通常更短。[齐昊·山]和 Unicorn 团队通过使用硬件代理在更长距离上中继 NFC 交互，降低了距离组件的安全性。

周日在 DEF CON 上进行的[演讲](https://www.defcon.org/html/defcon-25/dc-25-speakers.html#Shan)，概述了一些令人难以置信的简单硬件:一个连接到 [PN7462AU](http://www.nxp.com/products/identification-and-security/nfc-and-reader-ics/nfc-controller-solutions/nfc-controller-based-on-arm-cortex-m0-core-with-160-kb-flash-contact-interface:PN7462AUHN) 的 NFC 天线，一个 NRF24L01 无线收发器，以及一些电源调节。该漏洞利用通过使用一对这样的硬件模块来工作。主设备与 NFC 读卡器接口，从设备读取卡。场景大概是这样的:受害者 NFC 卡被放置在从硬件附近。主硬件放置在支付亭上，就像进行正常支付一样。当支付亭读卡器开始读取 NFC 卡时，它与实际卡之间的所有通信都通过 24L01 无线连接转发。

演讲期间的演示视频显示了在 Apple Pay 网络上购买快餐时，卡仍在用餐区的桌子上(放在从属硬件模块上)。使用的卡是中国银联的 QuickPass 非接触式支付卡。根据该公司 2016 年的新闻稿,当时已经发行了超过 20 亿张这样的卡。有了这样的采用率，就有巨大的动力去发现和修补系统中的任何漏洞。

这个版本中的硬件组件并没有什么特别的。这些年来，我们已经看到这些北欧无线模块在许多项目中使用，而恩智浦芯片只是围绕 ARM 内核构建的 NFC。将这两者联系在一起的飞跃是使其发挥作用的加速。NFC 有严格的时间限制，主设备和从设备之间的延迟会导致握手和后续交互无效。Unicorn 团队通过确保芯片从挂起模式(150 秒)中唤醒，而不是深度睡眠，找到了一些加速方法。此外，[齐昊]提到他们只传输“I/S/R 块数据”，而不是整个交互，以节省通过 24L01 无线链路传输的时间。他没有详细说明这一点，所以如果你有关于这些区块实际上由什么组成的细节，请在下面的评论中告诉我们。

对于读卡器来说，仿真支付卡是有效的，并且支付通过。但是对系统的一个警告是[齐昊]不能改变模拟器的 UID——它不能欺骗被利用的支付卡的 UID。当前的阅读器不检查 UID，这可能是对这种利用的一种可能的防御。但是说实话，因为你需要主人和读卡器以及支付卡的奴隶同时在物理上接近，所以我们看不到未来的混乱。更有可能的是，当有人建立一个远程链接，让你把 NFC 卡留在家里，随身携带一个仿真器，在单个设备中进行无线门禁或非接触式支付时，我们将看到黑客的信誉。如果你想开始这方面的工作，请查看[演讲幻灯片](https://media.defcon.org/DEF%20CON%2025/DEF%20CON%2025%20presentations/DEFCON-25-Haoqi-Shan-and-Jian-Yuan-Man-in-the-NFC.pdf)中的程序流程和一些源代码提示。
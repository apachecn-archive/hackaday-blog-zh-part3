# 统计学与黑客:假设检验导论

> 原文:[https://hack aday . com/2017/12/01/statistics-and-hacking-a-introduction-to-hypothesis-testing/](https://hackaday.com/2017/12/01/statistics-and-hacking-an-introduction-to-hypothesis-testing/)

在 20 世纪早期，都柏林的吉尼斯啤酒厂有一项政策，雇佣牛津和剑桥最好的毕业生来改进他们的工业流程。当时，他们使用统计方法来改进他们的工艺和产品，这被认为是一个商业秘密。

他们遇到的一个问题是 z 测试(当时常用的测试)需要大量的样本，并且经常得不到足够的数据。通过研究小样本的特性，[威廉·希利·戈塞](http://en.wikipedia.org/wiki/William_Sealy_Gosset)开发了一种统计测试，只需要较少的样本就能得出合理的结果。据说，吉尼斯的化学家被禁止发表他们的发现。

所以他做了我们很多人都会做的事情:意识到这一发现对于传播很重要，他采用了一个笔名(“学生”)并发表了它。即使我们现在知道是谁开发了这项测试，它仍然被称为“学生的 t-测试”,它仍然被广泛应用于科学领域。

这是一个关于数学、匿名和啤酒的可爱的小故事…但是我们能用它做什么呢？事实证明，鉴于我们一直在玩的联网传感器的数量，这可能是我们所有人都更经常使用的东西。今天我们的目标是涵盖假设检验和基本的 z 检验，因为这些是理解 t 检验如何工作的基础。我们很快会用真实的数据回到 t 检验。

我最近购买了两个流行的 DHT11 温湿度传感器。[数据表](http://akizukidenshi.com/download/ds/aosong/DHT11.pdf) (PDF 警告)说它们在一定范围内精确到+/- 2 摄氏度和 5%相对湿度。这很好，但这是否意味着我购买的两个特定传感器在相同条件下会产生明显不同的结果？不同到足以影响我如何使用它们？在我们讨论如何量化它之前，我们必须回顾一些基本的统计理论。如果你以前从未学过统计学，它可能不够直观，所以我们将在进入学生 t-检验的细节之前先检查一个更基本的检验。

首先值得一提的是，有两个主要的统计学派——贝叶斯学派和频率主义学派(他们之间有点圣战)。每一个的详细讨论不属于这里，虽然如果你想知道更多[这篇文章提供了一个合理的总结](http://scienceblogs.com/goodmath/2008/04/07/schools-of-thought-in-probabil/)。或者如果你更喜欢漫画，[这一个应该做](http://xkcd.com/1132/)。重要的是要记住，虽然我们的测试将依赖于对统计数据的频繁解释，但还有其他解决问题的正确方法。

以我们的例子为例，想象一下，你在一家生产 100 个ω电阻的工厂从事质量控制工作。机器从来都不是完美的，所以虽然生产的电阻器的平均值是 100ω，但是各个电阻器的值略有不同。围绕 100 个ω平均值的单个值的分布度量是标准差(σ)。如果您的机器工作正常，您可能还会注意到，偏离 100ω非常高的电阻较少，而接近 100ω的电阻较多。如果您要绘制每个值所产生的电阻数量，您可能会得到如下结果:

![](../Images/153c68c6c1a88e71b8278a5fe295a84a.png)

这是一条钟形曲线，也称为正态分布或高斯分布，你可能以前见过。如果您非常精明，您可能还会注意到，95%的电阻值都在平均值 100ω的两个标准偏差之内。如果您特别有决心，您甚至可以制作一个表格，定义在平均值的不同标准偏差范围内产生的电阻比例，供以后参考。幸运的是，[对于正态分布的数据，已经有了这样的表](http://sixsigmastudyguide.com/wp-content/uploads/2014/04/z-table.jpg)，并且用于最基本的假设检验:z 检验。

假设你买了一台生产 100 个ω电阻的机器，你辞去了 QC 的工作，现在有了自己的工厂。供应商似乎有点可疑，你怀疑机器实际上可能是有缺陷的，并产生以稍微不同的值为中心的电阻器。要解决这个问题，有四个步骤:开发一组假设，采样数据，检查采样数据是否符合测试的假设，然后运行测试。

## 发展假设

在我们的情况下只有两种可能:机器要么产生与 100ω明显不同的电阻，要么不产生。更正式的说法是，你有以下假设:

H0:机器不生产与 100ω相差很大的电阻

哈:机器生产的电阻与 100ω有很大不同

H0 被称为我们的零假设。在经典统计学中，它是一个基线，或者是一个假设，你可以假定它是有益的。在这里，这是一个假设，我们没有发现两台机器之间的差异。我们不想向制造商投诉，除非我们有明确的证据证明这台机器制造的电阻不好。

我们要做的是使用一个 [z-score 表](http://sixsigmastudyguide.com/wp-content/uploads/2014/04/z-table.jpg)来确定我们采取的一些样本与 H0 一致的概率。如果概率太低，我们会断定 H0 不可能是真的。因为唯一的替代假设是 HA，所以我们决定接受 HA 为真。

作为发展假设的一部分，你需要决定你对你的结果有多确定。一个常见的值是 95%的确定性(也写作 α =0.05)，但更高或更低的确定性都完全有效。既然在我们的情况下，我们是在指控某人卖给我们劣质商品，那么让我们先试着非常确定，并且 99%确定( α =0.01)。你应该提前决定并坚持下去——尽管没有人能真正检查你做了什么。不过，你只是在欺骗自己，这取决于你的读者来决定你的结果是否有足够的说服力。

## 抽样和检查假设

接下来你随机抽取数据样本。假设您用非常精确的万用表测量 400 个电阻的电阻，发现平均电阻为 100.5ω，标准偏差为 1ω。

第一步是检查您的数据是否大致呈钟形曲线。除非您购买了统计软件包，否则我发现最简单的方法是使用 Python 中的 scipy stats 包:

```
import scipy.stats as stats

list_containing_data=[]

result = stats.normaltest(list_containing_data)

print result
```

作为一个非常通用的规则，如果结果(作为‘pvalue’输出)大于 0.05，您可以继续。否则，您需要选择一个不假设特定数据分布的测试，或者对您的数据应用一个变换—我们将在几天后讨论这两个问题。顺便提一下，当需要时，正态性测试有时会被忽略，但结果还是会公布。所以，如果你的朋友忘了做这件事，友好地帮助他们——没有人希望第一次公开指出这件事(例如，论文答辩或论文发表后)。

## 执行测试

![](../Images/4b823ef1527734c8900c66f5d6c273ab.png)

σ: standard deviation, n: number of samples

既然困难的部分已经过去了，剩下的就可以手工完成了。为了进行测试，我们确定样本平均值距离 100ω有多少标准误差。标准误差是标准偏差除以样本大小的平方根。这就是为什么更大的样本量会让你对结果更有把握——在其他条件相同的情况下，随着样本量的增加，你的标准误差会减小。在我们的例子中，标准误差是 0.05ω。

## ![](../Images/598638cd4a92bd19de7d6136bd9d8273.png)

M: a value we’re testing against, µ: the sample average

接下来，我们计算测试统计量 z。这是样本平均值 100.5ω与我们测试的值 100ω之差除以标准误差。这使我们的 z 值为 10，这是一个相当大的值，因为 z 统计表通常只达到 3.49。这意味着假设零假设为真，获得我们观察到的样本的概率(p)小于 0.001(或者小于 0.1%，如果你愿意)。我们通常将其报告为 p < 0.001，因为当 p 这么小时，没有人真正关心它的精确值是多少。

## 这是什么意思？

由于我们计算出的 p 值低于阈值 α 值 0.01，我们拒绝了机器生产的电阻平均值为 100ω的无效假设……肯定存在偏移，但我们会联系供应商吗？

在现实生活中，统计意义只是等式的一部分。剩下的就是效果大小了。所以，没错，我们的机器明显不符合规格……但由于标准偏差为 1ω，无论如何也不足以产生 1%容差的电阻。尽管我们已经表明真实平均值高于 100ω，但它仍然非常接近，电阻很容易以 5%的容差出售。因此，尽管结果意义重大，但(虚构的)经济现实是，它可能无关紧要。

对于我们虚构的例子来说，这一切都很好，但是在现实生活中，收集数据往往既昂贵又耗时。作为黑客，我们的资源通常非常有限。这是我们今天讨论的 z 检验的一个重要限制，它需要相对较大的样本量。虽然互联网连接的传感器和数据记录在这些日子里并不昂贵，但一项能在我们的预算范围内提供更多知识的测试将会非常棒。

稍后，我们将通过使用来自物联网传感器的真实数据集的 Python 示例，详细介绍如何使用 t-test 实现这一点。
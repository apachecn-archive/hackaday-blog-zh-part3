# 电路虚拟现实:与电流源共存亡

> 原文:[https://hack aday . com/2018/05/03/circuit-VR-sink-or-swim-with-current-sources/](https://hackaday.com/2018/05/03/circuit-vr-sink-or-swim-with-current-sources/)

如果你在 1980 年后的某个时候开始研究电子学，你的第一个项目很可能是点亮 LED。微控制器项目也经常点亮 LED，闪烁的 LED 是嵌入式系统的“hello world”程序的一部分。如果你试着用 9 伏电池直接点亮你的 LED，你会发现它会亮。不管怎样，就一次。过量的电流会烧坏 LED，这就是为什么你需要一个限流电阻。然而，这些限流电阻实在不是电流源或吸电流的好借口。在许多应用中，你需要一个真正的电流源，幸运的是，它们并不难创建。

和往常一样，我们将使用 [LT Spice](http://www.linear.com/designtools/software/) 来检查电路。如果你需要一个快速教程，[从这里开始](https://hackaday.com/2016/02/26/adding-spice-to-your-workbench/)，之后再回来。如果你使用 Linux，不要沮丧。我把它放在酒里，效果很好。你可以在 [GitHub](https://github.com/wd5gnr/circuitvr) 上找到所有的 Spice 文件。

## 源或汇

继续这个例子，LED 实际上并不关心限流电阻。它关心流经它的电流。一般来说，电流越大，LED 越亮。简单电阻既便宜又简单，但也有局限性。首先，电源电压也会影响亮度。我们被使用稳压电源的系统惯坏了，但是一个使用非稳压电源的设备，比如汽车电池，在不同条件下可能会有很大范围的电压。你想要的是一种无论电源电压如何都能提供或吸收一定量电流的器件。

请记住，在单回路电路中，[电流在任何地方都是相同的](https://hackaday.com/2017/05/25/ohm-dont-forget-kirchhoff/)因此，控制流入或流出的电流量通常都无关紧要。提供电流(使用正电流惯例)的电路通常称为电流源，限制接地端电流的电路称为吸电流源。

led 并不是唯一需要电流源或电流宿的东西。例如，电池充电器可能使用恒定电流。高质量放大器通常使用电流源作为负载电阻。用恒定电流给电容器充电会产生一个很好的线性斜坡，而不是像用恒定电压充电时那样的曲线。

## 双极的

也许最简单的电流吸收器是 2N2222 这样的 NPN 晶体管。基极-发射极结看起来像一个二极管，假设正向偏置，发射极的电压将比基极低 0.7 V 左右。实际上，这个数字会随着温度和其他因素而略有变化，但对于普通的硅晶体管来说，0.7 V 已经足够接近了。

假设晶体管的贝塔系数很高——现代器件通常都很高——无论什么电流流过发射极，都会有效地流过集电极。这有点过于简单，因为它忽略了基极电流，但基极电流可能非常小，所以我们可以忽略它。

[![](../Images/d01346a7a19be368251c549ea5a8b9ea.png) ](https://hackaday.com/wp-content/uploads/2018/04/cir1.png) `D1`是一个带常用限流电阻的 LED。正向电压约为 2.7 V，电源电压为 12 V，因此电阻两端的电压约为 9.3 V。对于指定的电阻，这意味着电阻大约有 20 mA 电流通过，LED 也是如此。

然而，`D2`使用简单的电流吸收器。`R3`和`R4`在`Q1`的基础上将输入电压分压至 1.7 V 左右。这意味着发射极上的电压约为 1 V。如果你手工计算，你可能会认为`R3`和`R4`的值不会产生 1.7 V。我马上会告诉你为什么，但现在只要相信(如果你喜欢，通过运行模拟)基极电压是 1.7 V

事实上，下面是 spice 模拟的输出(有一点额外的注释):

```
--- Operating Point ---

V(vled): 2.74756 voltage      *LED drops about 2.75V*
V(n001): 12 voltage
V(vc): 9.25399 voltage        *About 12-2.75*
V(ve): 0.992536 voltage       *About .7V below Vb*
V(vb): 1.72943 voltage        *Set (more or less) by R3/R4*
Ic(Q1): 0.0197532 device_current     *Because Ib is small, |Ic| is about equal to |Ie|*
Ib(Q1): 9.74841e-005 device_current
Ie(Q1): -0.0198507 device_current    *|Ie| = |Ic+Ib| (sign is because of direction)*
I(D2): 0.0197532 device_current      *LED current close enough to 20 mA*
I(D1): 0.020114 device_current       LED current close enough to 20 mA
I(R4): 0.0101731 device_current
I(R3): 0.0102706 device_current
I(R2): 0.0198507 device_current      *Set by Ve/R2 which sets Ie which sets Ic*
I(R1): 0.020114 device_current
I(V1): -0.0501378 device_current
```

正如承诺的那样，`Ve`约为 1 V，这使得发射极电阻`R2`类似于 LED 限流电阻。从输出中可以看出，它的电压为 1 V，因此功耗为 20 mA。因为`Ic`在`Ie`的 100 微安左右的范围内，LED——`D2`——也有 20 毫安的电流通过。

## 这样好些了吗？

你可能想知道为什么那样更好。我们有几个额外的组件，得到基本相同的结果。事实是，正如我在这里画的那样，它真的好不了多少。这是因为设置电流的基极电压是固定的，取决于电源电压。但不一定非要这样。

例如，我可以将`R3`和`R4`换成一个电阻和一个齐纳二极管，甚至几个普通二极管，得到一个不依赖于电源电压的电压。我还可以改变基本电压，控制通过 LED 或其他负载设备的电流量。

然而，对于某些负载，这种电路可能比简单的电阻更好。假设你有一个黑匣子，而不是一个 LED。因为灯泡或马达或里面的东西，它看起来是一个电阻值变化的电阻。换句话说，如果你把电池放在它上面，它可能开始看起来像一个 1ω电阻，但几秒钟后，它看起来像一个 20ω电阻。启动时出现浪涌电流的情况并不少见。

利用限流电阻，这种变化的负载所消耗的电流量将随着有效电阻的变化而变化。但是对于我们简单的晶体管电路，20 mA 将总是流动。好吧。算是吧。

## 合规问题

实际的电流源有一定的顺从范围，因为它们不能提供无穷大的电压。让我们来看另一个模拟，看看它是如何工作的。

[![](../Images/fda7d6a592a79d589704e876f188c7a5.png)T2】](https://hackaday.com/wp-content/uploads/2018/04/cir2.png)

在这个电路中，PNP 晶体管提供电流。基极电压比发射极电压低大约 0.7 V。因此，当基极电压为 10.3 V 时，发射极电压约为 11 V，`R1`的电压约为 1 V。这设定了电流，但这次负载从集电极到地。

当负载电阻较低时，电路很容易提供所需的大约 100 mA 电流。毕竟，一个 10ω电阻只需要 1 V 的电压就可以实现。但该电路只能使集电极达到 11 V 左右，因此，100ω之后，情况就会变糟。从仿真图中可以看出，我将负载电阻从 1ω步进至 150ω:

[![](../Images/94b54c27bc0404936104907a91a62d3d.png)T2】](https://hackaday.com/wp-content/uploads/2018/04/graph1.png)

蓝色轨迹(从左下方开始，用于色盲)是通过电阻产生 98 mA 电流所需的电压。绿色轨迹是平坦的，直到到达 11 V 点。然后它急剧下降，因为电路不能提供更多的电压。

## 你所有的基础电压

为了使这个例子简单，我只是把一个完美的电压源放在底座上。但在第一个例子中，我使用了一个 1kω和 170ω电阻的分压器。如果你稍微算一下，你会发现 170/(170+1000)=0.15(大约)。因此，对于 12 V 电源，您可能会认为分压器产生 1.8 V 电压，但该例中的实际基极电压约低 1/10V。

原因很简单。`R4`的值实际上是发射极电阻(`R2`)乘以晶体管的β。由于`R4`很小，而`R2`乘以β可能很大(我猜至少是 50，000)，所以影响很小。然而，如果`R4`很大，这可能会产生严重的影响。

顺便说一句，我并不是在估算有效电阻上偷懒。晶体管的β不是一个非常稳定的参数，因此无论标称值是多少，它都会因电流、温度甚至器件不同而有很大差异。

## 但是等等，还有更多…

这些简单的电流源和吸电流非常有用。然而，还是有一些限制，我们将在未来研究一些电路，试图减轻这些限制。例如，fet 可以很好地做到这一点，只需要多一点数学运算。使用多个器件镜像电流也很常见，即获取一个参考电流并再现它。这听起来没什么用，但可以把它想象成电压的射极跟随器。源电压看到一个轻负载，并产生一个输出电压，可以提供更多的电流比原来的来源。电流镜也是如此。基准电流可能没有很宽的顺从电压范围，或者像电阻一样对负载敏感。该反射镜将提供稳定的负载，同时提供更稳定的输出电流。

如果你想尝试一个实验，用一个电容代替 PNP 电路上的负载电阻，然后进行瞬态分析。只需确保在分析命令行上设置 UIC 选项(选中“跳过初始操作点解决方案”复选框)。看看电容器上的电压。通过改变电流设置电阻和电容值，您可以创建不同的直线充电时间。你可以在网上找到我的解决方案。
# 糟糕的 RSA 库使得数百万密钥易受攻击

> 原文:[https://hack aday . com/2017/10/17/bad-RSA-library-leaves-million-of-keys-vulnerable/](https://hackaday.com/2017/10/17/bad-rsa-library-leaves-millions-of-keys-vulnerable/)

所以，呃…好消息，各位！在负责生成英飞凌科技股份有限公司制造的硬件芯片中使用的 RSA 密钥对的软件库中发现了一个漏洞。这个被称为 ROCA 的漏洞，允许攻击者通过[铜匠的攻击](https://en.wikipedia.org/wiki/Coppersmith%27s_attack)，只从公钥开始计算私钥，这几乎完全违背了非对称加密的目的。

受影响的硬件包括加密智能卡、安全令牌和英飞凌科技公司生产的其他安全硬件芯片。存在漏洞的库还集成在其他供应商的认证、签名和加密令牌以及用于操作系统可信引导的芯片中。包括微软、谷歌、惠普、联想和富士通在内的主要供应商已经发布了软件更新和缓解指南。

研究人员在各个领域发现并分析了易受攻击的密钥，包括电子公民文档(75 万张爱沙尼亚身份证)、认证令牌、可信引导设备、软件包签名、TLS/HTTPS 密钥和 PGP。目前确认发现的易受攻击的密钥数量约为 760，000 个，但可能会高出两到三个数量级。

追溯到至少 2012 年的设备受到影响，尽管已通过 NIST FIPS 140-2 和 CC EAL 5+认证..易受攻击的芯片不一定是英飞凌科技公司直接出售的，因为这些芯片可以嵌入其他制造商的设备中。

> 因式分解攻击的难度对于所有的密钥长度来说并不相同，并且并不严格地增加(一些较长的密钥可能比其他较短的密钥需要更少的时间来因式分解)。以下密钥长度范围现在被认为实际上是可因子分解的(时间复杂度最大为几小时到 1000 CPU 年):512 到 704 位、992 到 1216 位和 1984 到 2144 位。请注意，4096 位 RSA 密钥现在实际上是不可因子分解的，但如果攻击得到改进，可能会成为可因子分解的。
> 
> 所选密钥长度的时间复杂度和成本(英特尔 E5-2650 v3@3GHz Q2/2014):
> 
> *   512 位 RSA 密钥——2 个 CPU 小时(成本 0.06 美元)；
> *   1024 位 RSA 密钥–97 个 CPU 日(成本 40-80 美元)；
> *   2048 位 RSA 密钥–140.8 个 CPU 年，(成本为 2-4 万美元)。

请记住，这些基准测试是针对单个 CPU 的。对于某些三个字母的机构，人们必须假设攻击需要很少的时间来完成。话说回来，他们可能已经有了你的钥匙(需要引用)。

担心的用户可以在线测试他们的公钥，或者，更好的办法是，通过克隆 GitHub 库之后的 T2 来离线测试。如果使用带有 *pip* 的 Linux 版本，您可以尝试以下方法来测试您已知的公钥:

```

$ sudo pip install roca-detect

$ gpg -a --export &gt; /tmp/public &amp;&amp; roca-detect /tmp/public
2017-10-17 14:10:33 [7869] INFO ### SUMMARY ####################
2017-10-17 14:10:33 [7869] INFO Records tested: 93
2017-10-17 14:10:33 [7869] INFO .. PEM certs: . . . 0
2017-10-17 14:10:33 [7869] INFO .. DER certs: . . . 0
2017-10-17 14:10:33 [7869] INFO .. RSA key files: . 0
2017-10-17 14:10:33 [7869] INFO .. PGP master keys: 1
2017-10-17 14:10:33 [7869] INFO .. PGP total keys: 102
2017-10-17 14:10:33 [7869] INFO .. SSH keys: . . . 0
2017-10-17 14:10:33 [7869] INFO .. APK keys: . . . 0
2017-10-17 14:10:33 [7869] INFO .. JSON keys: . . . 0
2017-10-17 14:10:33 [7869] INFO .. LDIFF certs: . . 0
2017-10-17 14:10:33 [7869] INFO .. JKS certs: . . . 0
2017-10-17 14:10:33 [7869] INFO .. PKCS7: . . . . . 0
2017-10-17 14:10:33 [7869] INFO No fingerprinted keys found (OK)
2017-10-17 14:10:33 [7869] INFO ################################

```

在本例中，没有发现易受攻击的密钥。你找到了吗？如果是你的，撤销生成一个新的可能更好。似乎 2017 年每天都在给我们带来安全珍珠。昨天，我们哀悼了 WPA2 的去世，但是我们也看到了 that 被攻破，十亿部智能手机中的 Broadcom WiFi 被利用，大约 40%的设备无法修补蓝牙漏洞，你的证书被缓存在搜索引擎中。
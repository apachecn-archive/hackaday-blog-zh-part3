# 微控制器的电源时钟

> 原文:[https://hack aday . com/2017/04/15/mains-clocking-a-micro controller/](https://hackaday.com/2017/04/15/mains-clocking-a-microcontroller/)

[Lujji]正在摆弄 STM8 微控制器。在查阅该芯片的官方文档时，他发现外部时钟可以是正弦波、三角波或占空比为 50%的方波。最小 CPU 频率为 0 赫兹。[luji]没有信号发生器，大概，他没有水晶了。不过，他确实有交流电源，[那么为什么不用墙上电源](https://lujji.github.io/blog/bare-metal-programming-stm8-part2/)来为微控制器计时呢？

使用市电作为频率标准是一个有一百年历史的概念。同步电机以与电源频率成比例的速率转动，这已经在钟表中使用了几十年。如果你真的很聪明，[你可以用交流电源](http://hackaday.com/2011/04/10/flipflop-clock-uses-mains-frequency-to-keep-time/)为数字电路计时，但我们从未见过有人用交流电源取代微控制器电路中的微小晶体。

在一次实验证明了这个概念之后，[Lujji]继续构建一个电路，它不像将微控制器直接连接到墙上的插座上那么笨。无论如何，直接方法并不奏效 STM8 不喜欢边沿缓慢的低频时钟。[Lujji]需要一个边缘更干净的时钟，一个 555 配置为比较器符合要求。

完整的电路通过光耦合器发送主电源，以驱动配置为比较器的 555。输出是一个干净的 50Hz 时钟，连接到 STM8 的 OSCIN 引脚。这是一个运行在 50Hz 的芯片，是的，它工作了。[luji]设置一个电路，在一个旧的诺基亚液晶显示器上写“Hello World”。那花了大约三分钟。尽管它完全没用，但它确实有效。也许这可以应用于一些新颖的计时方式，类似于今年早些时候我们看到的每天一条指令的时钟。